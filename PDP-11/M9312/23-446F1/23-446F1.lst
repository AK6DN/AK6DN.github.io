       1                                	.title	Console/Diagnostic ROM for the 11/44
       2                                
       3                                	; This source code is an exact copy of the DEC 23-446F1 console PROM.
       4                                	;
       5                                	; This console/diagnostic PROM is for the 11/44 CPU.
       6                                	;
       7                                	; Standard devices are 82S137, 74S573 or other compatible bipolar PROMs
       8                                	; with a 1024x4 TriState 18pin DIP architecture.
       9                                
      10 000000                         	.asect
      11        165000                  	.=165000
      12                                
      13        165000                  base	=.
      14 165000 012737  177777  000706  START:	mov	#177777,@#706		;
      15 165006 000405                  	br	L1			;
      16 165010 005037  000706          L2:	clr	@#706			;
      17 165014 000402                  	br	L1			;
      18 165016 000240                  	nop				;
      19                                
      20        165020                  	.=base+20
      21 165020 000773                  DIAG:	br	L2			;
      22                                
      23 165022 010037  000700          L1:	mov	r0,@#700		;
      24 165026 010137  000702          	mov	r1,@#702		;
      25 165032 010437  000704          	mov	r4,@#704		;
      26 165036 012737  165676  000004  	mov	#N1,@#4			;
      27 165044 012737  000340  000006  	mov	#340,@#6		;
      28 165052 012737  165736  000030  	mov	#N2,@#30		;
      29 165060 012737  000340  000032  	mov	#340,@#32		;
      30 165066 000401                  	br	L3			;
      31 165070 000777                  	br	.			;
      32                                
      33 165072 005006                  L3:	clr	sp			;
      34 165074 100404                  	bmi	L5			;
      35 165076 102403                  	bvs	L5			;
      36 165100 101002                  	bhi	L5			;
      37 165102 002401                  	blt	L5			;
      38 165104 101401                  	blos	L6			;
      39 165106 000777                  L5:	br	.			;
      40                                
      41 165110 005306                  L6:	dec	sp			;
      42 165112 100003                  	bpl	L7			;
      43 165114 001402                  	beq	L7			;
      44 165116 002001                  	bge	L7			;
      45 165120 003401                  	ble	L8			;
      46 165122 000777                  L7:	br	.			;
      47                                
      48 165124 006006                  L8:	ror	sp			;
      49 165126 102002                  	bvc	L9			;
      50 165130 103001                  	bcc	L9			;
      51 165132 001001                  	bne	L10			;
      52 165134 000777                  L9:	br	.			;
      53                                
      54 165136 012706  125252          L10:	mov	#125252,sp		;
      55 165142 000402                  	br	L11			;
      56                                
      57        165144                  	.=base+144
      58 165144 000000                  NODIAG:	halt				;
      59 165146 000776                  	br	NODIAG			;
      60                                
      61 165150 010600                  L11:	mov	sp,r0			;
      62 165152 010001                  	mov	r0,r1			;
      63 165154 010102                  	mov	r1,r2			;
      64 165156 010203                  	mov	r2,r3			;
      65 165160 010304                  	mov	r3,r4			;
      66 165162 010405                  	mov	r4,r5			;
      67 165164 160501                  	sub	r5,r1			;
      68 165166 002401                  	blt	L12			;
      69 165170 001401                  	beq	L13			;
      70 165172 000777                  L12:	br	.			;
      71                                
      72 165174 006102                  L13:	rol	r2			;
      73 165176 103001                  	bcc	L14			;
      74 165200 002401                  	blt	L15			;
      75 165202 000777                  L14:	br	.			;
      76                                
      77 165204 060203                  L15:	add	r2,r3			;
      78 165206 005203                  	inc	r3			;
      79 165210 005103                  	com	r3			;
      80 165212 060301                  	add	r3,r1			;
      81 165214 103401                  	bcs	L16			;
      82 165216 003401                  	ble	L17			;
      83 165220 000777                  L16:	br	.			;
      84                                
      85 165222 006004                  L17:	ror	r4			;
      86 165224 050403                  	bis	r4,r3			;
      87 165226 060503                  	add	r5,r3			;
      88 165230 005203                  	inc	r3			;
      89 165232 103402                  	bcs	L18			;
      90 165234 005301                  	dec	r1			;
      91 165236 002401                  	blt	L19			;
      92 165240 000777                  L18:	br	.			;
      93                                
      94 165242 005100                  L19:	com	r0			;
      95 165244 101401                  	blos	L20			;
      96 165246 000777                  L21:	br	.			;
      97                                
      98 165250 040001                  L20:	bic	r0,r1			;
      99 165252 060101                  	add	r1,r1			;
     100 165254 003001                  	bgt	L22			;
     101 165256 003401                  	ble	L23			;
     102 165260 000777                  L22:	br	.			;
     103                                
     104 165262 000301                  L23:	swab	r1			;
     105 165264 020127  052125          	cmp	r1,#052125		;
     106 165270 001004                  	bne	L24			;
     107 165272 030405                  	bit	r4,r5			;
     108 165274 003002                  	bgt	L24			;
     109 165276 005105                  	com	r5			;
     110 165300 001001                  	bne	L25			;
     111 165302 000777                  L24:	br	.			;
     112                                
     113 165304 112700  177401          L25:	movb	#177401,r0		;
     114 165310 100001                  	bpl	L26			;
     115 165312 000777                  L27:	br	.			;
     116                                
     117 165314 077002                  L26:	sob	r0,L27			;
     118 165316 005001                  	clr	r1			;
     119 165320 005201                  L28:	inc	r1			;
     120 165322 077002                  	sob	r0,L28			;
     121 165324 005700                  	tst	r0			;
     122 165326 001002                  	bne	L29			;
     123 165330 005701                  	tst	r1			;
     124 165332 001401                  	beq	L30			;
     125 165334 000777                  L29:	br	.			;
     126                                
     127 165336 012706  000776          L30:	mov	#776,sp			;
     128 165342 004767  165350'         	jsr	pc,L31			;
     129 165346 000777                  L32:	br	.			;
     130                                
     131 165350 022716  165346          L31:	cmp	#L32,(sp)		;
     132 165354 001401                  	beq	L33			;
     133 165356 000777                  L34:	br	.			;
     134                                
     135 165360 012716  165370          L33:	mov	#N3,(sp)		;
     136 165364 000207                  	rts	pc			;
     137 165366 000777                  L35:	br	.			;
     138                                
     139 165370 005046                  N3:	clr	-(sp)			;
     140 165372 012746  165402          	mov	#N4,-(sp)		;
     141 165376 000002                  	rti				;
     142 165400 000777                  L36:	br	.			;
     143                                
     144 165402 000137  165410          N4:	jmp	@#N5			;
     145 165406 000777                  L37:	br	.			;
     146                                
     147 165410 012705  160000          N5:	mov	#160000,r5		;
     148 165414 005037  000006          	clr	@#6			;
     149 165420 012737  165426  000004  	mov	#N6,@#4			;
     150 165426 012706  000776          N6:	mov	#776,sp			;
     151 165432 005745                  	tst	-(r5)			;
     152 165434 012703  177746          	mov	#177746,r3		;
     153 165440 012737  165466  000004  	mov	#N7,@#4			;
     154 165446 012713  001015          	mov	#1015,(r3)		;
     155 165452 012737  165662  000114  	mov	#N8,@#114		;
     156 165460 005037  000116          	clr	@#116			;
     157 165464 000403                  	br	L38			;
     158 165466 012737  165676  000004  N7:	mov	#N1,@#4			;
     159 165474 012702  001000          L38:	mov	#1000,r2		;
     160 165500 010200                  	mov	r2,r0			;
     161 165502 010010                  L39:	mov	r0,(r0)			;
     162 165504 005720                  	tst	(r0)+			;
     163 165506 020005                  	cmp	r0,r5			;
     164 165510 101774                  	blos	L39			;
     165 165512 010200                  	mov	r2,r0			;
     166 165514 011001                  L41:	mov	(r0),r1			;
     167 165516 020001                  	cmp	r0,r1			;
     168 165520 001402                  	beq	L40			;
     169 165522 104000                  	emt	0			;
     170 165524 000000                  	halt				;
     171                                
     172 165526 005120                  L40:	com	(r0)+			;
     173 165530 020005                  	cmp	r0,r5			;
     174 165532 101770                  	blos	L41			;
     175 165534 014001                  L43:	mov	-(r0),r1		;
     176 165536 005101                  	com	r1			;
     177 165540 020001                  	cmp	r0,r1			;
     178 165542 001402                  	beq	L42			;
     179 165544 104000                  	emt	0			;
     180 165546 000000                  	halt				;
     181                                
     182 165550 020002                  L42:	cmp	r0,r2			;
     183 165552 001370                  	bne	L43			;
     184 165554 012737  165704  000004  	mov	#L51,@#4		;
     185 165562 000402                  	br	L44			;
     186                                
     187        165564                  	.=base+564
     188 165564 000167  165000'         RESTRT:	jmp	START			;
     189                                
     190 165570 005013                  L44:	clr	(r3)			;
     191 165572 012737  165676  000004  	mov	#N1,@#4			;
     192 165600 012702  001000          	mov	#1000,r2		;
     193 165604 010200                  	mov	r2,r0			;
     194 165606 010010                  L46:	mov	r0,(r0)			;
     195 165610 005720                  	tst	(r0)+			;
     196 165612 020005                  	cmp	r0,r5			;
     197 165614 101774                  	blos	L46			;
     198 165616 010200                  	mov	r2,r0			;
     199 165620 005110                  L50:	com	(r0)			;
     200 165622 005110                  	com	(r0)			;
     201 165624 021000                  	cmp	(r0),r0			;
     202 165626 001402                  	beq	L47			;
     203 165630 104000                  	emt	0			;
     204 165632 000000                  	halt				;
     205                                
     206 165634 005720                  L47:	tst	(r0)+			;
     207 165636 032737  000400  177750  	bit	#400,@#177750		;
     208 165644 001403                  	beq	L48			;
     209 165646 104000                  	emt	0			;
     210 165650 000000                  	halt				;
     211 165652 000406                  	br	L49			;
     212                                
     213 165654 020005                  L48:	cmp	r0,r5			;
     214 165656 101760                  	blos	L50			;
     215 165660 000411                  	br	L51			;
     216 165662 104000                  N8:	emt	0			;
     217 165664 000000                  L52:	halt				;
     218 165666 000776                  	br	L52			;
     219                                
     220 165670 012713  001015          L49:	mov	#1015,(r3)		;
     221 165674 000403                  	br	L51			;
     222 165676 104000                  N1:	emt	0			;
     223 165700 000000                  L53:	halt				;
     224 165702 000776                  	br	L53			;
     225                                
     226 165704 005737  000706          L51:	tst	@#706			;
     227 165710 001002                  	bne	L54			;
     228 165712 000000                  L55:	halt				;
     229 165714 000776                  	br	L55			;
     230                                
     231 165716 013700  000700          L54:	mov	@#700,r0		;
     232 165722 013701  000702          	mov	@#702,r1		;
     233 165726 013704  000704          	mov	@#704,r4		;
     234 165732 000164  000002          	jmp	2(r4)			;
     235                                
     236                                	; ------------------------------------------------------------
     237                                
     238 165736 012704  165762          N2:	mov	#A1,r4			;
     239 165742 105737  177564          L56:	tstb	@#177564		;
     240 165746 100375                  	bpl	L56			;
     241 165750 112437  177566          	movb	(r4)+,@#177566		;
     242 165754 105714                  	tstb	(r4)			;
     243 165756 001371                  	bne	L56			;
     244 165760 000002                  	rti				;
     245                                
     246 165762    015     012     105  A1:	.ascii	<015><012>"ERROR"<0><0><0>
         165765    122     122     117  
         165770    122     000     000  
         165773    000                  
     247                                
     248                                	; ------------------------------------------------------------
     249                                
     250        165774                  	.=base+774
     251 165774    060     103          verson:	.ascii	"0C"			; version ID
     252                                
     253        165776                  	.=base+776
     254 165776 124140                  crc16:	.word	<124140>		; CRC-16 will go here
     255                                
     256                                	.end
     256                                


Symbol table

.     =******           L19   =165242           L32   =165346           L48   =165654           N2    =165736           
A1    =165762           L2    =165010           L33   =165360           L49   =165670           N3    =165370           
BASE  =165000           L20   =165250           L34   =165356           L5    =165106           N4    =165402           
CRC16 =165776           L21   =165246           L35   =165366           L50   =165620           N5    =165410           
DIAG  =165020           L22   =165260           L36   =165400           L51   =165704           N6    =165426           
L1    =165022           L23   =165262           L37   =165406           L52   =165664           N7    =165466           
L10   =165136           L24   =165302           L38   =165474           L53   =165700           N8    =165662           
L11   =165150           L25   =165304           L39   =165502           L54   =165716           NODIAG=165144           
L12   =165172           L26   =165314           L40   =165526           L55   =165712           RESTRT=165564           
L13   =165174           L27   =165312           L41   =165514           L56   =165742           START =165000           
L14   =165202           L28   =165320           L42   =165550           L6    =165110           VERSON=165774           
L15   =165204           L29   =165334           L43   =165534           L7    =165122           
L16   =165220           L3    =165072           L44   =165570           L8    =165124           
L17   =165222           L30   =165336           L46   =165606           L9    =165134           
L18   =165240           L31   =165350           L47   =165634           N1    =165676           


Program sections:

. ABS.  166000    000   (RW,I,GBL,ABS,OVR,NOSAV)
        000000    001   (RW,I,LCL,REL,CON,NOSAV)
